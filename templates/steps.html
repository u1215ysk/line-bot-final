{% extends "layout.html" %}
{% block title %}ステップ配信{% endblock %}

{% block content %}
<h2><span style="font-size: 1.5em;">🗓️</span> ステップ配信シナリオ</h2>
<table>
    <thead>
        <tr>
            <th>登録後日数</th>
            <th>メッセージ内容</th>
            <th>操作</th>
        </tr>
    </thead>
    <tbody>
        {% for message in step_messages %}
        <tr>
            <td>{{ message.days_after }}日後</td>
            <td>{{ message.message_text|truncate(30) }}</td>
            <td>
                <form action="{{ url_for('delete_step', step_id=message.id) }}" method="post" onsubmit="return confirm('本当に削除しますか？');">
                    <button type="submit" class="button-delete">削除</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<h3>新しいシナリオを追加</h3>
<form action="/add-step" method="post">
    <input type="number" name="days_after" placeholder="登録後日数 (例: 3)" required>
    <textarea name="message_text" placeholder="送信するメッセージ内容" required></textarea>
    <button type="submit">シナリオ追加</button>
</form>
{% endblock %}